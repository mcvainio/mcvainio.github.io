<script src="https://cdn.jsdelivr.net/npm/three@0.141/build/three.min.js"></script>
<script src="../lib/TrackballControls.js"></script> 
<script src="../input data/simplesample-bigger.js"></script> 
<html><style>
body {
      margin: 0;
}
</style></html>


<script>
//set up scene and camera angle
  scene = new THREE.Scene();
  camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
  camera.position.set(0, -1.5, 1);

//create plane mesh
var subbdata = stripmap;
var numofpixels = subbdata.coords.length/4;
var segments = Math.sqrt(numofpixels)
  var geometry = new THREE.PlaneGeometry(1, 1, segments, segments).toNonIndexed();


//recolour vertices of plane
  var positionAttribute = geometry.getAttribute('position');

  const colors = [];
  const color = new THREE.Color();

  for (let i = 0; i < (numofpixels); i ++) {
    intens = subbdata.coords[i*4+3];
    color.setHSL(0, 0, intens/61);
//push the same colour out 6 times so that it colours all 6 vertices that form one pixel (square bisected by line into 2 triangles)
//later remember to deal with the moving sampling window
//you can handle this by making an if statement that colours in a transparent pixel if the intensity is NaN
    colors.push(color.r, color.g, color.b);
    colors.push(color.r, color.g, color.b);
    colors.push(color.r, color.g, color.b);
    colors.push(color.r, color.g, color.b);
    colors.push(color.r, color.g, color.b);
    colors.push(color.r, color.g, color.b);
  }

  geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));

//create a material for our mesh using the colours generated above
  const material = new THREE.MeshBasicMaterial({
    vertexColors: true,
    transparent: false,
    wireframe: false,
  });

//put it all together into one object and add to the scene
  const mesh = new THREE.Mesh(geometry, material);
  scene.add(mesh);
  mesh.material.side = THREE.DoubleSide

//set some rendering variables. necessary
  renderer = new THREE.WebGLRenderer({antialias: true});
  renderer.setPixelRatio(window.devicePixelRatio);
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);

//set up the camera controls. trackball controls are free-rotating while orbit controls will keep z+ oriented upwards.
  var controls = new THREE.TrackballControls(camera, renderer.domElement); 




//necessary render loop
function render() {
  requestAnimationFrame(render);
  renderer.render(scene, camera);
  controls.update();
}
render()
</script>
